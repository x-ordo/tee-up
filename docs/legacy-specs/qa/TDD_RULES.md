
## **AI 개발 에이전트  규칙집**

본 문서는 본 저장소에서 코드 생성·리팩터링·테스트 작성에 관여하는 모든 AI 에이전트(예: ChatGPT, Claude, GitHub Copilot 등)가 반드시 준수해야 하는 **절대 규칙집**이다.
이 규칙은 Kent Beck의 **TDD(Test-Driven Development)**, **Tidy First**, **Refactoring**, **Commit Discipline** 원칙을 엄격하게 따른다.

---

# 1. ROLE — AI의 역할

AI 에이전트는 **시니어 소프트웨어 엔지니어**로서 행동해야 하며, 다음 원칙을 철저히 수행한다:

* 모든 변경은 TDD 사이클에 따라 진행한다.
* 구조 변경과 기능 변경을 절대 혼합하지 않는다.
* 가장 단순하고 명확한 코드를 선택한다.
* 테스트 실패를 통해 “진행 방향”을 정의한다.
* 커밋 단위는 작고 의미 있어야 한다.

---

# 2. TDD CYCLE — 반드시 지켜야 하는 절차

AI는 아래 순서를 절대 어겨서는 안 된다.

## **1) Red — 실패하는 테스트 작성**

* 새로운 기능, 수정, 버그 픽스는 **반드시 실패하는 테스트로 시작한다**.
* 테스트의 목적은 “구체적이고 단일한 동작”을 정의하는 것이다.
* 테스트 이름은 명확한 행동 이름을 사용한다.

  * 예: `shouldReturnUserProfile()`

## **2) Green — 최소한으로 통과**

* 테스트를 통과시키는 **최소한의 코드만** 작성한다.
* 과도한 추상화·설계·성능 최적화는 금지.
* 테스트가 모두 Green 상태여야 다음 단계로 이동할 수 있다.

## **3) Refactor — 구조 개선**

* Green 상태에서만 구조 변경 가능.
* 리팩터링 시 **코드의 의미나 동작을 변경해서는 안 된다**.
* 테스트를 돌려 기존 동작이 유지되는지 계속 검증한다.

---

# 3. TIDY FIRST — 구조와 기능 사이의 경계

모든 변경은 아래 두 종류 중 하나이며, **한 커밋에 섞을 수 없다**.

### **1) Structural Changes — 구조 변경**

* 변수명 / 함수명 / 파일명 변경
* 코드 이동 / 폴더 구조 변경
* 메서드 추출 / 중복 제거
* 인터페이스 정리 / 의존성 명확화

### **2) Behavioral Changes — 동작 변경**

* 기능 추가
* 버그 수정
* API 수정
* 테스트 추가 및 변경

### 규칙

* 구조 변경이 필요하면 **먼저 Tidy First**로 정리 → 테스트 모두 Green → 커밋
* 그 다음 기능 변경을 TDD로 추가한다.

---

# 4. COMMIT DISCIPLINE — 커밋 규칙

모든 커밋은 다음을 만족해야 한다:

1. **모든 테스트 Green**
2. **코드 린터/포매터 무결성**
3. **하나의 논리 단위만 포함**
4. **구조 변경과 동작 변경을 절대 섞지 않는다**
5. 커밋 메시지에는 반드시 변경 타입을 명시:

예)

chore(structure): extract helper for S3 key generation
feat(behavior): implement getEvidenceList API with passing tests
fix(behavior): resolve null case for evidence parsing

---

# 5. CODE QUALITY — 코드 품질 기준

AI가 작성하는 코드와 테스트는 다음 원칙을 반드시 따른다.

### **단순함**

* 가장 간단한 설계
* 최소 상태, 최소 사이드이펙트

### **중복 제거**

* 동일 로직 반복을 허용하지 않음

### **명확한 의도 표현**

* 함수/변수명은 기능을 설명해야 한다
* 추상적인 이름 금지

### **작은 함수**

* 단일 책임 원칙(SRP)을 절대적으로 적용
* 10~20줄 이하 함수 지향

### **명확한 의존성**

* 모든 외부 의존성을 인젝션/파라미터 기반으로 처리
* 하드코딩된 숨겨진 의존성 금지

---

# 6. REFACTORING RULES — 리팩터링 규칙

Green 상태에서만 실행 가능.

### 허용 리팩터링 예

* Method Extraction
* Rename Variable / Function
* Move Function / File
* Inline Method
* Remove Duplication
* Simplify Conditionals
* Clarify Intent
* Replace Conditionals with Polymorphism

### 금지

* 구조 변경과 기능 변경 혼합
* 리팩터링 도중 테스트 실패 상태 유지
* 테스트 없는 코드 리팩터링

---

# 7. DEFECT FIXING PROCESS — 버그 수정 프로세스

버그는 다음 순서로 수정해야 한다.

1. **API 레벨에서 실패하는 테스트 작성**
2. **문제를 최소 단위로 재현하는 작은 테스트 추가**
3. 두 테스트 모두 빨강이어야 한다
4. 최소한의 코드로 Green
5. 필요 시 리팩터링
6. 구조/기능 분리하여 커밋

---

# 8. WORKFLOW — 작업 흐름 예시

1. 새 기능 필요 → 실패하는 테스트 작성 (Red)
2. 최소 구현 (Green)
3. 중복 제거, 구조 개선 (Refactor)
4. 커밋
5. 다음 테스트로 기능 확장

항상 **작은 사이클**을 통해 작업해야 한다.

---

# 9. 실행 지시

AI에게는 아래 하나의 명령만 존재한다:

"go"

AI가 `"go"`를 받으면 아래를 수행한다:

1. **다음 작성해야 할 테스트를 스스로 정의한다**
   (plan.md가 없으므로 기능 요구사항 또는 PRD 기반 테스트 정의)
2. 해당 테스트 작성 → Red
3. 최소 구현 → Green
4. 필요시 Refactor
5. 규칙에 맞게 구조/기능 분리하여 커밋에 해당하는 설명 생성

---

# 10. 금지 사항

AI는 다음을 절대 해서는 안 된다:

* 테스트 없이 기능 구현
* 테스트 Green 상태가 아닌데 리팩터링
* 구조 변경과 기능 변경을 한 번에
* 설계 과잉
* 추측 기반 구현
* 과도한 주석이나 문서화
* 테스트 여러 개를 한 번에 작성
* 여러 기능을 한 번에 구현

---

# 11. 문서 목적

이 문서는 아래 두 가지 목적을 가진다:

1. **AI 에이전트가 일관된 방식으로 코드를 생성하도록 강제**
2. **프로젝트 전체의 코드 품질, 구조, 테스팅 문화 기준 확립**
